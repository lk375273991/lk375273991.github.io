---
layout: post
title: C++中缺省类型的静态绑定
date: 2015-09-04
comments: true
---



	class A
	{
	public:
    	virtual void func(int val = 1)
    	{ std::cout<<"A->"<<val <<std::endl;}
    	virtual void test()
    	{ func();}
	};
	class B : public A
	{
	public:
    	void func(int val=0)
	{std::cout<<"B->"<<val <<std::endl;}
	};
	int main(int argc ,char* argv[])
	{
    	B*p = new B;
    	p->test();
		return 0;
	}

1.在非构造函数、非析构函数中调用虚函数是多态。所以p->test()是多态，调用B::func()
2.但输出并不是

	B->0
而是

	B->1
这是因为虚函数的的默认参数是静态绑定的。编译器在编译的时候为了效率，编译时进行的是静态绑定，即A::func，但是在运行的时候，却是B::func。如果声明的是

	A *p=new B;
则更清楚的看出这一点。
http://blog.csdn.net/chgaowei/article/details/6427731 对此有一个详细的解释。